<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>stateful.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">stateful</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="stateful.core.html"><div class="inner"><span>stateful.core</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="stateful.core.html#var-bind"><div class="inner"><span>bind</span></div></a></li><li class="depth-1"><a href="stateful.core.html#var-fmap"><div class="inner"><span>fmap</span></div></a></li><li class="depth-1"><a href="stateful.core.html#var-generator"><div class="inner"><span>generator</span></div></a></li><li class="depth-1"><a href="stateful.core.html#var-return"><div class="inner"><span>return</span></div></a></li><li class="depth-1"><a href="stateful.core.html#var-return*"><div class="inner"><span>return*</span></div></a></li><li class="depth-1"><a href="stateful.core.html#var-return-and-collect"><div class="inner"><span>return-and-collect</span></div></a></li><li class="depth-1"><a href="stateful.core.html#var-return-and-count"><div class="inner"><span>return-and-count</span></div></a></li><li class="depth-1"><a href="stateful.core.html#var-state"><div class="inner"><span>state</span></div></a></li><li class="depth-1"><a href="stateful.core.html#var-value"><div class="inner"><span>value</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">stateful.core</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-bind"><h3>bind</h3><div class="usage"><code>(bind gen f)</code></div><div class="doc"><div class="markdown"><p>Like test.check’s <code>bind</code> but uses a two parameter function passing both the generated value and the current state.</p>
<p>This function implicitly wraps <code>gen</code> with <a href="stateful.core.html#var-generator">generator</a>.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L151">view source</a></div></div><div class="public anchor" id="var-fmap"><h3>fmap</h3><div class="usage"><code>(fmap f gen)</code></div><div class="doc"><div class="markdown"><p>Like test.check’s <code>fmap</code> but uses a two parameter function passing both the generated value and the current state.</p>
<pre><code class="clojure">(stateful/fmap
  (fn [value {:keys [leaf-count]}]
    {:input-value         value
     :expected-leaf-count leaf-count})
  gen-tree)
</code></pre>
<p>This function implicitly wraps <code>gen</code> with <a href="stateful.core.html#var-generator">generator</a>.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L131">view source</a></div></div><div class="public anchor" id="var-generator"><h3>generator</h3><div class="usage"><code>(generator {:keys [gen], :as generator} &amp; [initial-state])</code></div><div class="doc"><div class="markdown"><p>Make the given generator stateful, allowing it access to an implicit state map including all changes made during the run.</p>
<pre><code class="clojure">(gen/generate
  (stateful/generator gen/int))
;; =&gt; 0
</code></pre>
<p>The output of the stateful generator will be the same as the one it wraps, but you can use the <a href="stateful.core.html#var-state">state</a> and <a href="stateful.core.html#var-value">value</a> generators to access the current state map.</p>
<pre><code class="clojure">(gen/generate
  (stateful/generator
    (gen/tuple gen/int (stateful/state))))
;; =&gt; [0 {}]
</code></pre>
<p>Additionally, you can supply an initial state value:</p>
<pre><code class="clojure">(gen/generate
  (stateful/generator
    (gen/tuple gen/int (stateful/state))
    {:number-of-elements 0}))
;; =&gt; [0 {:number-of-elements 0}]
</code></pre>
<p>Note that the scopes of nested stateful generators merge, i.e.:</p>
<pre><code class="clojure">(gen/generate
  (stateful/generator
    (gen/tuple
      (stateful/generator gen/int {:int? true})
      (stateful/generator gen/string {:string? true})
      (stateful/state))))
;; =&gt; [0 "" {:int? true, :string? true}]
</code></pre>
<p>The state can be manipulated using the <a href="stateful.core.html#var-return*">return*</a>, <a href="stateful.core.html#var-return">return</a>, etc… generators.</p>
<p>Please note that shrinking efficiency will most likely suffer if you’re using data added to the state by another generator.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L22">view source</a></div></div><div class="public anchor" id="var-return"><h3>return</h3><div class="usage"><code>(return v state)</code></div><div class="doc"><div class="markdown"><p>Like <a href="stateful.core.html#var-return*">return*</a>, merging the given map into the current state.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L187">view source</a></div></div><div class="public anchor" id="var-return*"><h3>return*</h3><div class="usage"><code>(return* v f &amp; args)</code></div><div class="doc"><div class="markdown"><p>Create a generator that updates the current state using the given function and arguments, before returning the given value.</p>
<pre><code class="clojure">(gen/generate
  (stateful/generator
    (stateful/return* 1 update :returned inc)
    {:returned 0}))
;; =&gt; [1 {:returned 1}]
</code></pre>
<p>You can use <a href="stateful.core.html#var-return">return</a>, <a href="stateful.core.html#var-return-and-count">return-and-count</a> or <a href="stateful.core.html#var-return-and-collect">return-and-collect</a> for some common use cases.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L165">view source</a></div></div><div class="public anchor" id="var-return-and-collect"><h3>return-and-collect</h3><div class="usage"><code>(return-and-collect v collection-key)</code><code>(return-and-collect v collection-key collect-value)</code></div><div class="doc"><div class="markdown"><p>Like <a href="stateful.core.html#var-return*">return*</a>, updating a list of values within the current state.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L198">view source</a></div></div><div class="public anchor" id="var-return-and-count"><h3>return-and-count</h3><div class="usage"><code>(return-and-count v counter-key)</code></div><div class="doc"><div class="markdown"><p>Like <a href="stateful.core.html#var-return*">return*</a>, updating a counter within the current state.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L193">view source</a></div></div><div class="public anchor" id="var-state"><h3>state</h3><div class="usage"><code>(state)</code></div><div class="doc"><div class="markdown"><p>Generator that returns the full current state map.</p>
<pre><code class="clojure">(gen/generate
  (stateful/generator
    (gen/fmap keys (stateful/state))
    {:some :state}))
;; =&gt; [(:some) {:some state}]
</code></pre>
<p>Use <a href="stateful.core.html#var-value">value</a> to access a certain value using its path into the map.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L92">view source</a></div></div><div class="public anchor" id="var-value"><h3>value</h3><div class="usage"><code>(value ks &amp; [default])</code></div><div class="doc"><div class="markdown"><p>Generator that looks up a path within the state map.</p>
<pre><code class="clojure">(gen/generate
  (stateful/generator
    (stateful/value [:some])
    {:some :state}))
;; =&gt; [:state {:some state}]
</code></pre>
<p>Use <a href="stateful.core.html#var-state">state</a> if you need access to the full state map.</p></div></div><div class="src-link"><a href="https://github.com/xsc/stateful/blob/master/src/stateful/core.clj#L111">view source</a></div></div></div></body></html>